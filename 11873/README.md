# 11873번 "최대 직사각형" 풀이 및 후기

| 바로가기  | <https://www.acmicpc.net/problem/11873> |
|-------|-----------------------------------------|
| 레이팅   | p3                                      |
| 푼 날짜  | 2023-08-06                              |
| 걸린 시간 | 50m                                     |

## 후기

첫 플레3입니다.

아이디어만 잘 생각하면 자잘한 조건도 없고 구현도 쉬웠습니다.

푸는데 25분,
최적화하는데 25분...

코틀린 함수형 기능들 남발하다가 시간초과나서 좀 고생했습니다.
프로파일러 동원해서 하나씩 최적화해야 했네요.

## 풀이

[1725](../1725) 히스토그램은 다들 풀었다고 가정합니다.
그걸 알면 착안하기도 쉽고 설명하기도 쉽습니다.

문제와 마찬가지로 N은 행의 개수, M은 열의 개수입니다.

왼쪽에서 오른쪽으로 연속된 1의 개수를 세다가 0이 나오면 0으로 리셋하는 방식으로, 누적 너비 배열(이중배열)을 만듭니다.
prefix sum의 변형으로 생각하시면 이해에 도움이 됩니다.

```text
0 1 0 1 1
1 1 1 1 1
0 1 1 1 0
1 1 1 1 1
```

예제의 이걸 다음으로 변환하는 것입니다.

```text
0 1 0 1 2
1 2 3 4 5
0 1 2 3 0
1 2 3 4 5
```

누적 너비 배열은 그 열의 각 원소들로부터 왼쪽 방향으로 뻗은 히스토그램 높이들을 의미합니다.
즉 저희는 M개의 열 각각에 대해 왼쪽으로 향하는 히스토그램 목록을 들고 있는 것입니다.

한 열에 대해 히스토그램 문제를 돌리면, 오른쪽 변이 그 열에 위치한 모든 직사각형 중 가장 큰 것의 넓이를 얻을 수 있습니다.
주어진 행렬에서 최대 직사각형의 오른쪽 변은 M개의 열 중 어떤 열 하나에 반드시 포함되어 있습니다.
따라서 누적 너비 배열의 각 열마다 히스토그램 문제를 M번 돌립시다.
그 중 최댓값이 바로 정답입니다.

예컨대 가장 왼쪽 열부터 슬라이싱(및 transpose)해서 히스토그램 문제를 돌리면

- 0 1 0 1 -> 1
- 1 2 1 2 -> 4
- 0 3 2 3 -> 6
- 1 4 3 4 -> 9
- 2 5 0 5 -> 5

이 중 max는 9이고 예제 1의 정답입니다.
3 * 3 크기고 오른쪽 변이 4번째 열에 있습니다.

제 코드는 편의상 저장할 때 columnWiseHeightsArray란 변수에 transpose된 형태로 저장했습니다.
그러면 열을 따로 슬라이스하지 않고 columnWiseHeightsArray[column] 형태로 슬라이싱된 걸 받을 수 있기 때문입니다.
